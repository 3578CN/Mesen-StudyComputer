<Window
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:vm="using:Mesen.ViewModels"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    x:Class="Mesen.Windows.DiskManagementWindow"
    Width="420" Height="520"
    Title="磁盘管理"
    DragDrop.AllowDrop="True"
    x:DataType="vm:DiskManagementViewModel">
    <Design.DataContext>
        <vm:DiskManagementViewModel />
    </Design.DataContext>

    <!-- 磁盘管理对话框：监听磁盘 I/O 通知自动刷新 -->
    <DockPanel Margin="8">
        <Border DockPanel.Dock="Top" Margin="0 0 0 8">
            <StackPanel Orientation="Horizontal" Spacing="10" VerticalAlignment="Center">
                <TextBlock Text="{Binding StatusText}" VerticalAlignment="Center" />
            </StackPanel>
        </Border>

        <Border BorderThickness="1" BorderBrush="{StaticResource MesenGrayBorderColor}">
            <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" Padding="0">
                <!-- 标题行放在 ScrollViewer 内部，使其随列表一起滚动并与行模板对齐 -->
                <StackPanel>
                    <!-- 标题使用与全局 DataTemplate 相同的列定义，确保列对齐 -->
                    <Grid ColumnDefinitions="120,50,50,80" Margin="0 2 0 4">
                        <TextBlock Grid.Column="0" Text="名称" VerticalAlignment="Center" FontWeight="SemiBold" />
                        <TextBlock Grid.Column="1" Text="修改时间" VerticalAlignment="Center" Opacity="0.8" />
                        <TextBlock Grid.Column="2" Text="类型" VerticalAlignment="Center" Opacity="0.8" />
                        <TextBlock Grid.Column="3" Text="大小" VerticalAlignment="Center" HorizontalAlignment="Right" Opacity="0.8" />
                    </Grid>

                    <!-- 移除对 Viewport.Width 的强制绑定，使 ItemsControl 能根据内容宽度伸展，
                         并将水平对齐改为 Left，以便当内容宽度大于 ScrollViewer 时出现横向滚动条 -->
                    <ItemsControl ItemsSource="{Binding Items}" HorizontalAlignment="Left" />
                </StackPanel>
            </ScrollViewer>
        </Border>
    </DockPanel>
</Window>